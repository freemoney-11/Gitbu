<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>WinGo 1 Min Widget</title>

<style>

body, html {
  margin: 0;
  padding: 0;
  height: 100%;
  overflow: hidden;
  background: black;
  font-family: Arial, sans-serif;
}

iframe {
  position: fixed;
  top: 0; left: 0;
  width: 100%;
  height: 100%;
  border: none;
}

/* Floating Predict Button */
#widget {
  position: fixed;
  right: 20px;
  top: 50%;
  transform: translateY(-50%);
  width: 75px;
  height: 75px;
  background: linear-gradient(45deg, #ff0059, #0077ff, #8e2de2);
  border-radius: 50%;
  animation: glow 3s infinite;
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;
  font-weight: bold;
  cursor: pointer;
  z-index: 9999;
}

@keyframes glow {
  0% { box-shadow: 0 0 15px red; }
  33% { box-shadow: 0 0 15px blue; }
  66% { box-shadow: 0 0 15px green; }
  100% { box-shadow: 0 0 15px purple; }
}

/* Prediction Panel */
#panel {
  position: fixed;
  right: 20px;
  top: 50%;
  transform: translateY(-50%);
  width: 280px;
  padding: 20px;
  background: rgba(20,20,20,0.85);
  backdrop-filter: blur(10px);
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.15);
  color: white;
  display: none;
  z-index: 99999;
  box-shadow: 0 0 20px #000;
}

button {
  width: 100%;
  padding: 14px;
  margin-top: 10px;
  background: #ff0037;
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 17px;
  font-weight: bold;
  cursor: pointer;
  transition: 0.2s;
}

button:hover {
  background: #d6002d;
}

#resultBox {
  margin-top: 15px;
  font-size: 22px;
  font-weight: bold;
  text-align: center;
  transition: all 0.25s ease-in-out;
}

/* Color circles */
.ball {
  display: inline-block;
  padding: 5px 12px;
  border-radius: 50px;
  color: white;
  font-weight: bold;
}

.red { background: #ff0037; }
.green { background: #00c853; }
.violet { background: #9c27b0; }

</style>
</head>
<body>

<!-- MAIN WEBSITE -->
<iframe src="https://www.dmwin15.com/#/register?invitationCode=583522131503"></iframe>

<!-- FLOATING BUTTON -->
<div id="widget">PREDICT</div>

<!-- PANEL -->
<div id="panel">
  <h3>WinGo 1 Min</h3>

  <button onclick="getPrediction()">Get Prediction</button>

  <div id="resultBox"></div>

  <button style="background:#444" onclick="closePanel()">Back</button>
</div>

<!-- SOUND -->
<audio id="ding">
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_eb3b88e2f9.mp3">
</audio>

<script>

const widget = document.getElementById("widget");
const panel = document.getElementById("panel");
const resultBox = document.getElementById("resultBox");
const ding = document.getElementById("ding");

widget.onclick = () => {
  widget.style.display = "none";
  panel.style.display = "block";
};

function closePanel() {
  panel.style.display = "none";
  widget.style.display = "flex";
}

/* ---------------------------------------------------
   FINAL CORRECT PERIOD NUMBER (MATCHES WEBSITE)
---------------------------------------------------- */
function getCurrentPeriodNumber() {
    const now = new Date();

    let y = now.getFullYear();
    let m = String(now.getMonth() + 1).padStart(2,"0");
    let d = String(now.getDate()).padStart(2,"0");

    let base = `${y}${m}${d}10000`;

    let hour = now.getHours();
    let minute = now.getMinutes();

    let minutesNow = hour*60 + minute;

    // REAL decoded startIndex from your screenshot
    const startIndex = 9671;

    let periodIndex = startIndex + minutesNow;

    return base + periodIndex;
}

/* ---------------------------------------------------
   SAME PERIOD = SAME RESULT
---------------------------------------------------- */

let savedResults = {};
let lastShownPeriod = "";

/* COLOR LOGIC */
function getColor(num) {
  if (num === 0 || num === 5) return "violet";
  if (num % 2 === 0) return "red";
  return "green";
}

/* CREATE RESULT */
function calculateResult(period) {

    if (savedResults[period]) return savedResults[period];

    let rand = Math.floor(Math.random()*10);
    let type = rand <= 4 ? "SMALL" : "BIG";
    let color = getColor(rand);

    let res = { rand, type, color };
    savedResults[period] = res;

    return res;
}

/* ---------------------------------------------------
   MAIN GET PREDICTION
---------------------------------------------------- */
function getPrediction() {

    let period = getCurrentPeriodNumber();

    if (period === lastShownPeriod) {
        showMessage("Please wait for next periodâ€¦");
        return;
    }

    lastShownPeriod = period;

    let result = calculateResult(period);

    ding.play();

    showResult(`
        Period: ${period}<br>
        Number: <span class="ball ${result.color}">${result.rand}</span><br>
        Result: ${result.type}
    `);
}

/* AUTO RESET AFTER PERIOD CHANGE */
setInterval(() => {
    let current = getCurrentPeriodNumber();
    if (current !== lastShownPeriod) {
        resultBox.innerHTML = "";
        lastShownPeriod = "";
    }
}, 3000);

/* ANIMATIONS */
function showResult(html) {
    resultBox.style.opacity = "0";
    resultBox.style.transform = "scale(0.8)";
    setTimeout(()=>{
      resultBox.innerHTML = html;
      resultBox.style.opacity = "1";
      resultBox.style.transform = "scale(1)";
    },150);
}

function showMessage(msg) {
    resultBox.innerHTML = `<span style='color:yellow'>${msg}</span>`;
}

</script>

</body>
</html>
